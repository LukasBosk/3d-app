<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muzeum regionu Boskovicka 3D prohlížeč</title>
    <script src="./tailwind.min.js"></script> 
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5; /* Světle šedé pozadí pro HTML stránku */
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh; /* Zajišťuje, že body zabírá celou výšku viewportu */
            box-sizing: border-box;
        }
        .container {
            width: 100%;
            max-width: 700px; /* Větší max-width pro 3D scénu */
            background-color: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px; /* Mezera mezi logem a nadpisem */
            margin-bottom: 10px;
        }
        .header img {
            max-height: 60px; /* Velikost loga */
            width: auto;
            border-radius: 8px; /* Zaoblené rohy loga */
        }
        h1 {
            color: #1a73e8;
            font-size: 2em; /* Mírně menší nadpis */
            font-weight: bold;
            margin: 0; /* Odstranění výchozího marginu */
        }
        p {
            color: #555;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Změněno z 220px na 250px */
            gap: 15px;
            margin-bottom: 30px;
        }
        .model-button {
            background-color: #4285f4;
            color: white;
            padding: 15px 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .model-button:hover {
            background-color: #357ae8;
            transform: translateY(-2px);
        }
        .model-button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        #loadingMessage {
            color: #f4b400;
            font-weight: bold;
            margin-top: 10px;
            display: none; /* Skryté na začátku */
        }
        #errorMessage {
            color: #ea4335;
            font-weight: bold;
            margin-top: 10px;
            display: none; /* Skryté na začátku */
        }

        #canvasContainer, #modelViewerElement {
            width: 100%;
            height: 500px; /* Pevná výška pro 3D canvas / model-viewer */
            background-color: transparent; /* Průhledné pozadí pro 3D canvas */
            border-radius: 10px;
            overflow: hidden; /* Zajištění, že obsah nepřeteče */
            /* display: none; je nyní řízeno JavaScriptem */
            justify-content: center;
            align-items: center;
            position: relative;
        }
        #canvasContainer canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .viewer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .back-button, .ar-button {
            background-color: #f4b400; /* Google žlutá pro zpět */
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .back-button:hover, .ar-button:hover:not(:disabled) {
            background-color: #e0a300;
            transform: translateY(-2px);
        }
        .back-button:active, .ar-button:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .ar-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        /* Styly pro přepínací tlačítka režimů */
        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .mode-toggle button {
            padding: 10px 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f0f0f0;
            color: #555;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            font-weight: bold;
        }
        .mode-toggle button.active {
            background-color: #4285f4;
            color: white;
            border-color: #4285f4;
        }
    </style>
    <script src="./three.min.js"></script>
    <script src="./GLTFLoader.js"></script>
    <script src="./OBJLoader.js"></script>
    <script src="./MTLLoader.js"></script>
    <script src="./OrbitControls.js"></script>
    <script src="./jszip.min.js"></script>
    <script type="module" src="./model-viewer.min.js"></script>
    <script nomodule src="./model-viewer-umd.js"></script>
</head>
<body>
    <div class="container">
        <div id="modelListSection">
            <div class="header">
                <img src="./logo.png" alt="Logo Muzea regionu Boskovicka">
                <h1>Muzeum regionu Boskovicka 3D prohlížeč</h1>
            </div>
            <p>Vyberte 3D model, který chcete prozkoumat.</p>

            <div class="mode-toggle">
                <button id="mode3dButton" class="active">Prohlížeč (3D)</button>
                <button id="modeArButton">AR (Rozšířená realita)</button>
            </div>

            <div class="model-grid" id="modelGrid">
                </div>
        </div>

        <div id="modelViewerSection" style="display: none; flex-direction: column; align-items: center;">
            <div id="canvasContainer" style="display: none;">
                </div>
            <model-viewer id="modelViewerElement"
                          ar
                          ar-modes="webxr scene-viewer quick-look"
                          camera-controls
                          environment-intensity="0" 
                          shadow-intensity="0" 
                          camera-orbit="0deg 75deg 1.5m"  style="width: 100%; height: 500px;">
            </model-viewer>

            <div id="loadingMessage">Načítání modelu...</div>
            <div id="errorMessage"></div>
            
            <div class="viewer-controls">
                <button class="back-button" id="backButton">Zpět na seznam modelů</button>
                <button class="ar-button" id="arButton" disabled>Zobrazit v AR (pouze GLB)</button>
            </div>
        </div>
    </div>

    <script>
        // Three.js scéna, kamera a renderer
        let scene, camera, renderer, controls;
        let currentModel = null; 
        let currentViewMode = '3d'; // '3d' pro prohlížeč (Sketchfab), 'ar' pro rozšířenou realitu (GLB)

        // Získání DOM elementů
        const modelListSection = document.getElementById('modelListSection');
        const modelViewerSection = document.getElementById('modelViewerSection');
        const modelGrid = document.getElementById('modelGrid');
        const canvasContainer = document.getElementById('canvasContainer'); 
        const modelViewerElement = document.getElementById('modelViewerElement'); 
        const loadingMessage = document.getElementById('loadingMessage');
        const errorMessage = document.getElementById('errorMessage');
        const backButton = document.getElementById('backButton');
        const arButton = document.getElementById('arButton');
        // Odstraněny reference na heightControl a heightSlider

        // Definice modelů s názvy, cestami a typy
        const models = [
            // GLB modely pro AR
            // PŘIDEJTE VLASTNÍ CESTY K SKETCHFAB HTML STRÁNKÁM ZDE
            { name: "Dláto", path: "./Dlato.glb", type: "glb", sketchfabPage: "./Dlato.html" },
            { name: "Dláto s tulejí", path: "./Dlatostuleji.glb", type: "glb", sketchfabPage: "./Dlatostuleji.html" },
            { name: "Kladívko", path: "./Kladivko.glb", type: "glb", sketchfabPage: "./Kladivko.html" },
            { name: "Náramek", path: "./Naramek.glb", type: "glb", sketchfabPage: "./Naramek.html" },
            { name: "Sekera s tulejí", path: "./Sekera.glb", type: "glb", sketchfabPage: "./Sekera.html" },
            { name: "Srp", path: "./Srp.glb", type: "glb", sketchfabPage: "./Srp.html" },
            { name: "Tordovaný kruh", path: "./Tordovanykruh.glb", type: "glb", sketchfabPage: "./Tordovanykruh.html" },
            { name: "Udidlo", path: "./Udidlo.glb", type: "glb", sketchfabPage: "./Udidlo.html" },
            { name: "Lunicovitý závěsek", path: "./Zavesek1.glb", type: "glb", sketchfabPage: "./Zavesek1.html" },
            { name: "Kolečkovitý závěsek", path: "./Zavesek2.glb", type: "glb", sketchfabPage: "./Zavesek2.html" },
            { name: "Závěsek", path: "./Zavesek3.glb", type: "glb", sketchfabPage: "./Zavesek3.html" },
            { name: "Depot Jabloňany", path: "./jablonany.glb", type: "glb", sketchfabPage: "./jablonany.html" },
            { name: "Depot Boskovice úr. 1", path: "./boskovice.glb", type: "glb", sketchfabPage: "./boskovice.html" },
            { name: "Depot Boskovice úr. 2", path: "./depotboskovice2.glb", type: "glb", sketchfabPage: "./depotboskovice2.html" }
            // Pokud byste měl i jiné typy modelů, které chcete zobrazovat v Three.js v 3D režimu, můžete je přidat zde
            // { name: "Můj OBJ model", path: "./my_model.obj", type: "obj", sketchfabPage: null }, // Příklad pro OBJ, který nemá Sketchfab stránku
        ];

        /**
         * Inicializuje Three.js scénu, kameru a renderer.
         * Tato inicializace je potřeba pro OBJ/ZIP modely.
         */
        function initThreeJS() {
            if (typeof THREE === 'undefined') {
                console.error("THREE.js knihovna není dostupná. Three.js modely (OBJ/ZIP) nebudou fungovat.");
                errorMessage.innerHTML = "<strong>CHYBA NAČÍTÁNÍ:</strong> Knihovna THREE.js nebyla nalezena.<br>" +
                                         "Ujistěte se, že jste stáhli soubor '<code>three.min.js</code>' a umístili jej " +
                                         "do <strong>stejné složky</strong> jako tento HTML soubor.";
                errorMessage.style.display = 'block';
                return;
            }

            scene = new THREE.Scene();
            scene.background = null; 

            camera = new THREE.PerspectiveCamera(75, canvasContainer.clientWidth / canvasContainer.clientHeight, 0.1, 1000);
            camera.position.set(0, 0, 5); 

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true }); 
            renderer.setSize(canvasContainer.clientWidth, canvasContainer.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio); 
            renderer.setClearColor(0x000000, 0); 
            canvasContainer.appendChild(renderer.domElement); 

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true; 
            controls.dampingFactor = 0.05;
            controls.screenSpacePanning = false; 
            controls.minDistance = 1; 
            controls.maxDistance = 50; 
            controls.minPolarAngle = 0; 
            controls.maxPolarAngle = Math.PI; 

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4); 
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.3); 
            directionalLight.position.set(5, 10, 7);
            scene.add(directionalLight);

            window.addEventListener('resize', onWindowResize);
            animate();
        }

        function onWindowResize() {
            if (canvasContainer.style.display === 'flex') {
                camera.aspect = canvasContainer.clientWidth / canvasContainer.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvasContainer.clientWidth, canvasContainer.clientHeight);
                controls.update();
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            if (canvasContainer.style.display === 'flex') {
                controls.update();
                renderer.render(scene, camera);
            }
        }

        // Three.js model loading functions (zůstávají v kódu, ale nebudou volány z hlavního menu)
        async function loadModelIntoThreeJS(modelPath) {
            loadingMessage.style.display = 'block';
            loadingMessage.textContent = 'Načítání modelu...';
            errorMessage.style.display = 'none';

            if (currentModel) {
                scene.remove(currentModel);
                currentModel.traverse(object => {
                    if (object.isMesh) {
                        object.geometry.dispose();
                        if (Array.isArray(object.material)) {
                            for (const material of object.material) cleanMaterial(material);
                        } else {
                            cleanMaterial(object.material);
                        }
                    }
                });
                currentModel = null;
            }

            const fileExtension = modelPath.split('.').pop().toLowerCase();
            try {
                if (fileExtension === 'obj') {
                    const loader = new THREE.OBJLoader();
                    loader.load(modelPath, (obj) => {
                        currentModel = obj;
                        centerModelGeometry(currentModel);
                        scene.add(currentModel);
                        fitCameraToModel(currentModel, camera, controls);
                        loadingMessage.style.display = 'none';
                    }, undefined, (error) => {
                        console.error('Chyba při načítání OBJ modelu:', error);
                        errorMessage.textContent = 'Chyba při načítání OBJ modelu. (Poznámka: OBJ modely bez .mtl souborů nemusí mít textury/barvy)';
                        errorMessage.style.display = 'block';
                        loadingMessage.style.display = 'none';
                    });
                } else if (fileExtension === 'zip') {
                    const response = await fetch(modelPath);
                    if (!response.ok) {
                        throw new Error(`Nepodařilo se načíst ZIP soubor: ${response.statusText}`);
                    }
                    const arrayBuffer = await response.arrayBuffer();

                    const zip = await JSZip.loadAsync(arrayBuffer);
                    let objContent = null;
                    let mtlContent = null;
                    const textureMap = new Map();

                    for (const filename in zip.files) {
                        const zipEntry = zip.files[filename];
                        const lowerFilename = filename.toLowerCase();

                        if (lowerFilename.endsWith('.obj')) {
                            objContent = await zipEntry.async('string');
                        } else if (lowerFilename.endsWith('.mtl')) {
                            mtlContent = await zipEntry.async('string');
                        } else if (lowerFilename.endsWith('.jpg') || lowerFilename.endsWith('.png') || lowerFilename.endsWith('.jpeg')) {
                            const dataUrl = `data:${zipEntry.mimeType};base64,${await zipEntry.async('base64')}`;
                            textureMap.set(filename.split('/').pop(), dataUrl);
                        }
                    }

                    if (!objContent) {
                        throw new Error('ZIP archiv neobsahuje soubor .obj.');
                    }

                    let materials = null;
                    if (mtlContent) {
                        const mtlLoader = new THREE.MTLLoader();
                        mtlLoader.manager = new THREE.LoadingManager();
                        mtlLoader.manager.setURLModifier((url) => {
                            const filename = url.split('/').pop();
                            if (textureMap.has(filename)) {
                                return textureMap.get(filename);
                            }
                            return url;
                        });

                        materials = mtlLoader.parse(mtlContent);
                        materials.preload();
                    }

                    const objLoader = new THREE.OBJLoader();
                    if (materials) {
                        objLoader.setMaterials(materials);
                    }

                    const obj = objLoader.parse(objContent);
                    currentModel = obj;
                    centerModelGeometry(currentModel);
                    scene.add(currentModel);
                    fitCameraToModel(currentModel, camera, controls);
                    loadingMessage.style.display = 'none';

                } else {
                    errorMessage.textContent = 'Neočekávaný formát souboru pro Three.js. Měl by být .obj nebo .zip.';
                    errorMessage.style.display = 'block';
                    loadingMessage.style.display = 'none';
                }
            } catch (error) {
                console.error('Obecná chyba při načítání souboru do Three.js:', error);
                errorMessage.textContent = `Došlo k chybě při načítání: ${error.message}`;
                errorMessage.style.display = 'block';
                loadingMessage.style.display = 'none';
            }
        }

        function fitCameraToModel(object, camera, controls) {
            const box = new THREE.Box3().setFromObject(object);
            const center = box.getCenter(new THREE.Vector3());
            const size = box.getSize(new THREE.Vector3());

            const maxDim = Math.max(size.x, size.y, size.z);
            const fov = camera.fov * (Math.PI / 180);
            let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));

            cameraZ *= 1.2;

            camera.position.set(0, 0, cameraZ);
            camera.lookAt(new THREE.Vector3(0, 0, 0));

            controls.target.copy(new THREE.Vector3(0, 0, 0));
            controls.update();
        }

        function centerModelGeometry(object) {
            const box = new THREE.Box3().setFromObject(object);
            const center = box.getCenter(new THREE.Vector3());
            object.position.sub(center);
        }

        function cleanMaterial(material) {
            if (Array.isArray(material)) {
                for (const mat of material) {
                    cleanMaterial(mat);
                }
                return;
            }

            for (const key in material) {
                const value = material[key];
                if (value && typeof value === 'object' && value.isTexture) {
                    value.dispose();
                }
            }

            if (material.dispose) {
                material.dispose();
            }
        }

        /**
         * Zpracuje kliknutí na tlačítko modelu na základě aktuálního režimu.
         * @param {object} model - Objekt modelu s názvem, cestou a typem.
         * @param {string} mode - '3d' pro Sketchfab, 'ar' pro GLB/AR.
         */
        function handleModelClick(model, mode) {
            if (mode === '3d') {
                // V režimu "3D" přesměrujeme na stránku Sketchfab.
                if (model.sketchfabPage) {
                    window.location.href = model.sketchfabPage;
                } else {
                    errorMessage.textContent = `Model ${model.name} nemá definovanou stránku pro 3D prohlížeč (Sketchfab).`;
                    errorMessage.style.display = 'block';
                }
            } else if (mode === 'ar') {
                // V režimu "AR" zobrazíme GLB model v model-viewer a rovnou aktivujeme AR.
                if (model.type === 'glb') {
                    modelListSection.style.display = 'none';
                    modelViewerSection.style.display = 'flex';

                    loadingMessage.style.display = 'block';
                    loadingMessage.textContent = 'Načítání modelu pro AR...';
                    errorMessage.style.display = 'none';

                    canvasContainer.style.display = 'none'; // Skryjeme Three.js canvas
                    modelViewerElement.style.display = 'block'; // Zobrazíme model-viewer
                    arButton.disabled = true; // Zakažte AR tlačítko, dokud se model nenačte
                    // Odstraněn kód pro zobrazení a reset posuvníku
                    modelViewerElement.setAttribute('translation', '0 0 0'); // Resetujeme pozici modelu v AR

                    modelViewerElement.src = model.path;
                    modelViewerElement.alt = model.name;
                    modelViewerElement.setAttribute('data-auto-ar', 'true'); // Nastavíme značku pro auto-aktivaci AR
                } else {
                    errorMessage.textContent = `Model ${model.name} není GLB formátu a nelze jej zobrazit v AR režimu.`;
                    errorMessage.style.display = 'block';
                }
            }
        }

        function showModelList() {
            modelViewerSection.style.display = 'none';
            modelListSection.style.display = 'block';

            // Vyčistíme model ze scény Three.js, pokud byl použit
            if (currentModel) {
                scene.remove(currentModel);
                currentModel.traverse(object => {
                    if (object.isMesh) {
                        object.geometry.dispose();
                        if (Array.isArray(object.material)) {
                            for (const material of object.material) cleanMaterial(material);
                        } else {
                            cleanMaterial(object.material);
                        }
                    }
                });
                currentModel = null;
            }
            // Resetujeme kameru a ovládání Three.js do výchozího stavu
            if (camera && controls) {
                camera.position.set(0, 0, 5);
                camera.lookAt(new THREE.Vector3(0, 0, 0));
                controls.target.set(0, 0, 0);
                controls.update();
            }

            // Vyčistíme <model-viewer>
            modelViewerElement.src = '';
            modelViewerElement.style.display = 'none';
            arButton.disabled = true;
            modelViewerElement.removeAttribute('data-auto-ar'); // Odstraníme značku auto-AR

            // Skryjeme zprávy o načítání/chybách
            loadingMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // Odstraněn kód pro skrytí a reset posuvníku
            
            generateModelButtons(); // Regenerate buttons to reflect current mode
        }

        /**
         * Generuje tlačítka modelů na základě pole 'models' a aktuálního režimu.
         */
        function generateModelButtons() {
            modelGrid.innerHTML = ''; // Vyčistíme mřížku před generováním
            models.forEach(model => {
                const button = document.createElement('button');
                button.className = 'model-button';
                button.textContent = model.name;
                button.addEventListener('click', () => {
                    handleModelClick(model, currentViewMode); // Voláme novou funkci handleModelClick
                });
                modelGrid.appendChild(button);
            });
            updateButtonTooltips(); // Aktualizujeme tooltips a stav tlačítek po vygenerování
        }

        // Posluchače událostí pro přepínací tlačítka režimů
        mode3dButton.addEventListener('click', () => {
            currentViewMode = '3d';
            mode3dButton.classList.add('active');
            modeArButton.classList.remove('active');
            generateModelButtons(); // Regenerujeme tlačítka pro 3D režim
        });

        modeArButton.addEventListener('click', () => {
            currentViewMode = 'ar';
            modeArButton.classList.add('active');
            mode3dButton.classList.remove('active');
            generateModelButtons(); // Regenerujeme tlačítka pro AR režim
        });

        // Přidá tooltips a zakáže/povolí tlačítka na základě režimu
        function updateButtonTooltips() {
            const buttons = modelGrid.querySelectorAll('.model-button');
            buttons.forEach((button, index) => {
                const model = models[index];
                if (currentViewMode === '3d') {
                    button.title = model.sketchfabPage ? `Otevřít 3D prohlížeč pro ${model.name}` : `3D prohlížeč (Sketchfab) není k dispozici pro ${model.name}`;
                    button.disabled = !model.sketchfabPage; // Zakázat, pokud není definována Sketchfab stránka
                } else if (currentViewMode === 'ar') {
                    button.title = model.type === 'glb' ? `Zobrazit ${model.name} v rozšířené realitě` : `Model ${model.name} není kompatibilní s AR`;
                    button.disabled = model.type !== 'glb'; // Zakázat, pokud není GLB
                }
            });
        }

        // Posluchač událostí pro tlačítko zpět
        backButton.addEventListener('click', showModelList);

        // Posluchač událostí pro tlačítko AR
        arButton.addEventListener('click', async () => {
            if (modelViewerElement && modelViewerElement.canActivateAR) {
                modelViewerElement.activateAR();
            } else {
                errorMessage.textContent = "AR nelze aktivovat. Ujistěte se, že stránka běží na HTTPS a vaše zařízení podporuje WebXR.";
                errorMessage.style.display = 'block';
            }
        });

        // Odstraněn posluchač událostí pro posuvník výšky


        // --- Posluchače událostí pro <model-viewer> ---
        modelViewerElement.addEventListener('load', () => {
            loadingMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            arButton.disabled = false; // Povolíme AR tlačítko, pokud se model načetl
            
            // Pokud je nastavena značka pro auto-aktivaci AR, aktivujeme AR
            if (modelViewerElement.hasAttribute('data-auto-ar')) {
                modelViewerElement.removeAttribute('data-auto-ar'); // Odstraníme značku
                if (modelViewerElement.canActivateAR) {
                    modelViewerElement.activateAR();
                } else {
                    errorMessage.textContent = "AR nelze aktivovat automaticky. Ujistěte se, že stránka běží na HTTPS a vaše zařízení podporuje WebXR.";
                    errorMessage.style.display = 'block';
                }
            }
        });

        modelViewerElement.addEventListener('error', (event) => {
            loadingMessage.style.display = 'none';
            errorMessage.textContent = 'Chyba při načítání modelu v AR prohlížeči. Zkuste jiný model nebo zkontrolujte soubor.';
            errorMessage.style.display = 'block';
            console.error('Model-viewer: Chyba při načítání modelu:', event);
        });

        modelViewerElement.addEventListener('progress', (event) => {
            if (event.detail.totalBytes) {
                const loaded = event.detail.receivedBytes;
                const total = event.detail.totalBytes;
                const percentage = Math.round((loaded / total) * 100);
                loadingMessage.textContent = `Načítání modelu... ${percentage}%`;
            } else {
                loadingMessage.textContent = `Načítání modelu...`;
            }
            loadingMessage.style.display = 'block';
        });
        // --- Konec posluchačů událostí ---


        // Inicializace při načtení stránky
        document.addEventListener('DOMContentLoaded', () => {
            initThreeJS(); // Three.js inicializujeme vždy
            generateModelButtons(); // Generujeme tlačítka poprvé
            // updateButtonTooltips(); // Již voláno uvnitř generateModelButtons
        });
    </script>
</body>
</html>
